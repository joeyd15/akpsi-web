<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>AKPsi Portal</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet">

  <!-- Bootstrap CSS & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root{
      --akpsi-gold: #C9A227;
    }

    body {
      font-family: 'Raleway', sans-serif;
      background: #a5c1eb;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .navbar {
      background: rgba(0,0,0,0.85) !important;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    .navbar-brand { letter-spacing: 0.5px; }

    .navbar-nav .nav-link {
      opacity: 0.9;
      transition: opacity 0.15s ease;
    }
    .navbar-nav .nav-link:hover { opacity: 1; }

    .home-hero {
      margin-top: 100px;
      padding: 4rem 0;
    }

    .hero-card {
      background: #ffffffc2;
      border-radius: 18px;
      padding: 3.5rem;
      box-shadow: 0 20px 45px rgba(0,0,0,0.12);
    }

    .hero-title {
      font-weight: 700;
      font-size: 2.35rem;
      color: #111;
      letter-spacing: 0.2px;
    }

    .hero-subtitle {
      font-size: 1.12rem;
      color: #555;
      line-height: 1.7;
      margin-bottom: 1rem;
    }

    .hero-values {
      margin-top: 1.25rem;
      font-weight: 700;
      color: #003366;
      letter-spacing: 0.35px;
    }

    .hero-image-wrapper {
      background: #e9ecef;
      border-radius: 14px;
      padding: 0.75rem;
    }

    .hero-image-wrapper img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      object-fit: cover;
      display: block;
    }

    @media (max-width: 768px) {
      .hero-card { padding: 2.25rem; }
      .hero-title { font-size: 2rem; }
    }
  </style>
</head>

<body>

  <!-- âœ… Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm fixed-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">AKPsi Portal</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMenu">
        <ul class="navbar-nav ms-auto">
          <!-- Always visible -->
          <li class="nav-item"><a class="nav-link active" href="index.html">Home</a></li>

          <!-- Role-based links (hidden by default) -->
          <li class="nav-item d-none" id="membersLink"><a class="nav-link" href="members.html">Members</a></li>

          <!-- Brother-only -->
          <li class="nav-item d-none" id="submitMentionLink"><a class="nav-link" href="mentions.html">Submit Mention</a></li>
          <li class="nav-item d-none" id="pnmPics"><a class="nav-link" href="pnms-pics.html"> PNM Pictures</a></li>
          <li class="nav-item d-none" id="submitInterviewLink"><a class="nav-link" href="interview.html">Submit Interview</a></li>
          <li class="nav-item d-none" id="myCreditsLink"><a class="nav-link" href="my-credits.html">My Credits</a></li>
          <li class="nav-item d-none" id="votingNightLink"><a class="nav-link" href="voting.html">Voting Night</a></li>

          <!-- âœ… PNM + Brother (their own profile only) -->
          <li class="nav-item d-none" id="editProfileLink"><a class="nav-link" href="edit-profile.html">Edit Profile</a></li>

          <!-- PNM-only -->
          <li class="nav-item d-none" id="pnmApplicationLink"><a class="nav-link" href="application.html">PNM Application</a></li>

          <!-- Admin-only -->
          <li class="nav-item d-none" id="adminPortalLink"><a class="nav-link" href="admin-portal.html">Admin Portal</a></li>
          <li class="nav-item d-none" id="pnmDashboardLink"><a class="nav-link" href="pnm-dashboard.html">PNM Dashboard</a></li>
          <li class="nav-item d-none" id="rushDashboardLink"><a class="nav-link" href="rush-dashboard.html">Rush Dashboard</a></li>
          <li class="nav-item d-none" id="interviewDashboardLink"><a class="nav-link" href="interview-dashboard.html">Interview Dashboard</a></li>

          <!-- âœ… Admin can upload ANYONE's photo -->
         <li class="nav-item d-none" id="uploadPNMPhotosLink"><a class="nav-link" href="upload-photo.html">Upload Photos</a></li>


          <!-- Greeting (only when signed in) -->
          <li class="nav-item d-none" id="greetingItem"><a class="nav-link" id="greeting">Hi!</a></li>

          <!-- Auth button (always visible) -->
          <li class="nav-item">
            <a class="btn btn-outline-light ms-2" href="signin.html" id="authButton">Sign In</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- âœ… New Homepage Hero -->
  <main class="container home-hero">
    <div class="hero-card">
      <div class="row align-items-center g-5">

        <!-- LEFT: Text -->
        <div class="col-md-7 text-start">
          <h1 class="hero-title mb-3">
            Alpha Kappa Psi <br>
            Zeta Lambda Chapter
          </h1>

          <p class="hero-subtitle">
            We are a <strong>business professional fraternity</strong> at the
            <strong>University of Tennessee</strong>, committed to building principled leaders through professional
            development, lifelong relationships, and meaningful service.
          </p>

          <p class="hero-subtitle">
            Our chapter is continuously growing focused on expanding our impact and developing members through a strong
            brotherhood rooted in opportunity, accountability, and leadership.
          </p>

          <div class="hero-values">
            Brotherhood â€¢ Unity â€¢ Integrity â€¢ Knowledge â€¢ Service
          </div>
        </div>

        <!-- RIGHT: Image -->
        <div class="col-md-5">
          <div class="hero-image-wrapper">
            <img src="images/homepage.png" alt="Alpha Kappa Psi Zeta Lambda Chapter">
          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- ðŸ”¥ Firebase Auth + Role Logic -->
  <script type="module">
    import { auth, db } from "./jsauth.js";
    import { doc, getDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";

    const authButton = document.getElementById("authButton");

    const greetingItem = document.getElementById("greetingItem");
    const greeting = document.getElementById("greeting");

    const membersLink = document.getElementById("membersLink");

    const submitMentionLink = document.getElementById("submitMentionLink");
    const submitInterviewLink = document.getElementById("submitInterviewLink");
    const myCreditsLink = document.getElementById("myCreditsLink");
    const votingNightLink = document.getElementById("votingNightLink");
    const pnmPics = document.getElementById("pnmPics");


    const editProfileLink = document.getElementById("editProfileLink");
    const pnmApplicationLink = document.getElementById("pnmApplicationLink");

    const adminPortalLink = document.getElementById("adminPortalLink");
    const pnmDashboardLink = document.getElementById("pnmDashboardLink");
    const rushDashboardLink = document.getElementById("rushDashboardLink");
    const interviewDashboardLink = document.getElementById("interviewDashboardLink");
    const uploadPNMPhotosLink = document.getElementById("uploadPNMPhotosLink");

    function hideAllRoleLinks() {
      [
        greetingItem,
        membersLink,
        submitMentionLink,
        submitInterviewLink,
        myCreditsLink,
        votingNightLink,
        editProfileLink,
        pnmPics,
        pnmApplicationLink,
        adminPortalLink,
        pnmDashboardLink,
        rushDashboardLink,
        interviewDashboardLink,
        uploadPNMPhotosLink
      ].forEach(el => { if (el) el.classList.add("d-none"); });
    }

    onAuthStateChanged(auth, async (user) => {
      // Default (logged out)
      hideAllRoleLinks();
      authButton.textContent = "Sign In";
      authButton.href = "signin.html";
      authButton.onclick = null;

      if (!user) return;

      // Fetch role from Firestore
      let role = "pnm";
      let firstName = user.email;

      try {
        const userSnap = await getDoc(doc(db, "users", user.uid));
        if (userSnap.exists()) {
          role = (userSnap.data().role || "pnm").toLowerCase();
          firstName = userSnap.data().firstName || user.email;
        }
      } catch (e) {
        console.error("Error loading user role:", e);
      }

      // Greeting + logout
      greetingItem.classList.remove("d-none");
      greeting.textContent = `Hi, ${firstName}!`;

      authButton.textContent = "Log Out";
      authButton.href = "#";
      authButton.onclick = async (e) => {
        e.preventDefault();
        await signOut(auth);
        window.location.href = "signin.html";
      };

      // Always signed-in links
      membersLink.classList.remove("d-none");

      // âœ… Let PNMs/Brothers/Admin open Edit Profile (it should only allow editing their own data)
      editProfileLink.classList.remove("d-none");

      // Role-based links
      if (role === "pnm") {
        pnmApplicationLink.classList.remove("d-none");
        return;
      }

      if (role === "brother") {
        submitMentionLink.classList.remove("d-none");
        submitInterviewLink.classList.remove("d-none");
        myCreditsLink.classList.remove("d-none");
        votingNightLink.classList.remove("d-none");
        pnmPics.classList.remove("d-none");
        return;
      }

      if (role === "admin") {
        adminPortalLink.classList.remove("d-none");
        pnmDashboardLink.classList.remove("d-none");
        rushDashboardLink.classList.remove("d-none");
        interviewDashboardLink.classList.remove("d-none");
        uploadPNMPhotosLink.classList.remove("d-none");
        pnmPics.classList.remove("d-none");
        return;
      }
    });
  </script>

  <script src="/chat-widget.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
